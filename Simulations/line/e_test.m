function E_test = e_test(M, T, point, u, n,Theta)
m1=M(1,1); m2=M(1,2); m3=M(1,3); m4=M(1,4);
m5=M(2,1); m6=M(2,2); m7=M(2,3); m8=M(2,4);
m9=M(3,1);m10=M(3,2);m11=M(3,3);m12=M(3,4);
p1=point(1);p2=point(2);p3=point(3); 
u1=u(1);u2=u(2);u3=u(3);
r1=T(1,1);r2=T(1,2);r3=T(1,3);r4=T(2,1);r5=T(2,2);r6=T(2,3);r7=T(3,1);r8=T(3,2);r9=T(3,3);
t1=T(1,4);t2=T(2,4);t3=T(3,4);
n1=n(1);n2=n(2);n3=n(3);

% temp = [0 0 0 -r1*t2+r4*t1 0 0 0 0 -r2*t2+r5*t1 0 0 -r1*t3+r7*t1 0 -r3*t2+r6*t1 0 0 0 0 0 -r2*t3+r8*t1 0 0 0 -r3*t3+r9*t1 +r1*t2-r4*t1 0 0 0 0 +r2*t2-r5*t1 0 +r3*t2-r6*t1 +r1*t3-r7*t1 0 +r2*t3-r8*t1 +r3*t3-r9*t1 0 0 0 0 -r4*t3+r7*t2 0 +r4*t3-r7*t2 0 0 0 -r5*t3+r8*t2 +r5*t3-r8*t2 0 0 -r6*t3+r9*t2 +r6*t3-r9*t2 0 0 0 0 0 0 0 0 -r7 0 0 +r7 0 0 -r4 -r8 0 0 0 +r8 +r4 0 -r5 -r9 0 0 0 0 +r9 +r5 -r6 0 0 0 0 +r6 0 0 0 0 0 0 0 0 +r1*r8-r2*r7 -r1*r8+r2*r7 0 0 0 0 0 0 0 0 +r1*r9-r3*r7 -r1*r9+r3*r7 +r1*r5-r2*r4 -r1*r5+r2*r4 0 0 0 0 0 0 0 0 0 0 +r2*r9-r3*r8 -r2*r9+r3*r8 +r1*r6-r3*r4 -r1*r6+r3*r4 0 0 0 0 0 0 0 0 0 0 +r2*r6-r3*r5 -r2*r6+r3*r5 0 0 0 0 0 0 0 0 -r1*r8+r2*r7 +r1*r8-r2*r7 0 0 0 0 -r1*r5+r2*r4 +r1*r5-r2*r4 -r1*r9+r3*r7 +r1*r9-r3*r7 0 0 -r1*r6+r3*r4 +r1*r6-r3*r4 -r2*r9+r3*r8 +r2*r9-r3*r8 -r2*r6+r3*r5 +r2*r6-r3*r5 0 0 -r1 0 -r2 0 0 -r3 0 0 0 0 0 0 +r1 0 +r2 +r3 0 0 0 0 0 0 0 0 +r4*r8-r5*r7 -r4*r8+r5*r7 0 0 -r4*r8+r5*r7 +r4*r8-r5*r7 0 0 0 0 0 0 +r4*r9-r6*r7 -r4*r9+r6*r7 -r4*r9+r6*r7 +r4*r9-r6*r7 0 0 0 0 +r5*r9-r6*r8 -r5*r9+r6*r8 -r5*r9+r6*r8 +r5*r9-r6*r8 0 0 0 0 ;+r1*t2-r4*t1 +r2*t2-r5*t1 +r1*t3-r7*t1 0 +r3*t2-r6*t1 0 0 +r2*t3-r8*t1 0 0 0 0 +r3*t3-r9*t1 0 -r1*t2+r4*t1 0 0 0 0 0 -r2*t2+r5*t1 0 0 0 0 -r3*t2+r6*t1 -r1*t3+r7*t1 0 0 0 -r2*t3+r8*t1 0 0 -r3*t3+r9*t1 0 0 +r4*t3-r7*t2 -r4*t3+r7*t2 +r5*t3-r8*t2 -r5*t3+r8*t2 0 +r6*t3-r9*t2 0 -r6*t3+r9*t2 0 0 0 0 0 0 0 0 0 0 +r7 -r7 +r4 +r8 -r8 -r4 0 +r5 +r9 0 -r9 -r5 0 0 +r6 0 0 0 0 -r6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -r1*r8+r2*r7 +r1*r8-r2*r7 -r1*r9+r3*r7 +r1*r9-r3*r7 -r1*r5+r2*r4 +r1*r5-r2*r4 0 0 -r2*r9+r3*r8 +r2*r9-r3*r8 -r1*r6+r3*r4 +r1*r6-r3*r4 0 0 0 0 0 0 0 0 -r2*r6+r3*r5 +r2*r6-r3*r5 0 0 0 0 0 0 0 0 0 0 0 0 +r1*r8-r2*r7 -r1*r8+r2*r7 0 0 0 0 0 0 0 0 0 0 +r1*r5-r2*r4 -r1*r5+r2*r4 +r1*r9-r3*r7 -r1*r9+r3*r7 0 0 0 0 0 0 +r1*r6-r3*r4 -r1*r6+r3*r4 +r2*r9-r3*r8 -r2*r9+r3*r8 0 0 0 0 +r2*r6-r3*r5 -r2*r6+r3*r5 0 0 0 0 0 0 +r1 +r2 0 +r3 0 0 0 0 0 0 -r1 0 0 -r2 0 -r3 0 0 -r4*r8+r5*r7 +r4*r8-r5*r7 +r4*r8-r5*r7 -r4*r8+r5*r7 -r4*r9+r6*r7 +r4*r9-r6*r7 +r4*r9-r6*r7 -r4*r9+r6*r7 0 0 -r5*r9+r6*r8 +r5*r9-r6*r8 0 0 +r5*r9-r6*r8 -r5*r9+r6*r8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ;0 0 0 0 0 -r1*t2+r4*t1 +r1*t2-r4*t1 0 0 -r2*t2+r5*t1 +r2*t2-r5*t1 0 0 0 0 -r3*t2+r6*t1 -r1*t3+r7*t1 +r3*t2-r6*t1 +r1*t3-r7*t1 0 0 -r2*t3+r8*t1 +r2*t3-r8*t1 0 0 0 0 -r3*t3+r9*t1 +r3*t3-r9*t1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -r4*t3+r7*t2 +r4*t3-r7*t2 0 0 -r5*t3+r8*t2 +r5*t3-r8*t2 0 0 -r6*t3+r9*t2 +r6*t3-r9*t2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -r7 +r7 0 0 0 0 0 -r4 -r8 +r4 +r8 0 0 0 -r5 -r9 +r5 +r9 0 -r6 +r6 0 0 0 0 0 0 0 0 0 0 0 0 +r1*r8-r2*r7 -r1*r8+r2*r7 -r1*r8+r2*r7 +r1*r8-r2*r7 0 0 0 0 0 0 +r1*r5-r2*r4 -r1*r5+r2*r4 +r1*r9-r3*r7 -r1*r9+r3*r7 -r1*r5+r2*r4 +r1*r5-r2*r4 -r1*r9+r3*r7 +r1*r9-r3*r7 0 0 0 0 0 0 +r1*r6-r3*r4 -r1*r6+r3*r4 +r2*r9-r3*r8 -r2*r9+r3*r8 -r1*r6+r3*r4 +r1*r6-r3*r4 -r2*r9+r3*r8 +r2*r9-r3*r8 0 0 0 0 0 0 +r2*r6-r3*r5 -r2*r6+r3*r5 -r2*r6+r3*r5 +r2*r6-r3*r5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -r1 +r1 0 -r2 +r2 0 -r3 +r3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 +r4*r8-r5*r7 -r4*r8+r5*r7 -r4*r8+r5*r7 +r4*r8-r5*r7 0 0 0 0 +r4*r9-r6*r7 -r4*r9+r6*r7 -r4*r9+r6*r7 +r4*r9-r6*r7 0 0 0 0 +r5*r9-r6*r8 -r5*r9+r6*r8 -r5*r9+r6*r8 +r5*r9-r6*r8 ;];
% b_esti = temp * Theta;
b_esti = cross(M * T * [point; 1], M  * T * [u; 0]);
E_test = b_esti - (b_esti.' * n) * n;